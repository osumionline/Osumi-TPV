<div class="lineas-ventas">
	<div class="linea-venta" *ngFor="let linea of venta.lineas; let i = index">
		<div class="col-localizador">
			<input *ngIf="!linea.idArticulo" type="number" id="loc-new" class="linea-localizador" (keyup)="checkLocalizador($event, i)" [(ngModel)]="linea.localizador" [disabled]="searching" aria-label="Localizador">
			<ng-container *ngIf="linea.idArticulo">{{linea.localizador}}</ng-container>
			<mat-icon *ngIf="linea.idArticulo" class="delete-linea" title="¿Borrar línea?" (click)="borraLinea(i)">delete</mat-icon>
		</div>
		<div class="col-descripcion">
			<ng-container *ngIf="!linea.descripcion">&nbsp;</ng-container>
			<span *ngIf="linea.descripcion" [routerLink]="['/articulos', linea.localizador]">{{linea.descripcion}}</span>
		</div>
		<div class="col-stock">
			<ng-container *ngIf="!linea.stock">&nbsp;</ng-container>
			<span *ngIf="linea.stock">{{linea.stock}}</span>
		</div>
		<div class="col-cantidad">
			<ng-container *ngIf="linea.idArticulo === null">&nbsp;</ng-container>
			<input type="number" *ngIf="linea.idArticulo !== null" [(ngModel)]="linea.cantidad" class="linea-cantidad" (keyup)="updateCantidad(i)" (click)="selectCantidad($event)">
		</div>
		<div class="col-pvp">
			<ng-container *ngIf="!linea.pvp">&nbsp;</ng-container>
			<span *ngIf="linea.pvp">{{linea.pvp}} €</span>
		</div>
		<div class="col-importe">
			<ng-container *ngIf="!linea.importe">&nbsp;</ng-container>
			<span *ngIf="linea.importe">{{linea.total | fixedNumber}} €</span>
		</div>
		<div class="col-descuentos">
			<ng-container *ngIf="linea.descuento === null">&nbsp;</ng-container>
			<span *ngIf="linea.descuento !== null" (click)="abreDescuento(linea)">{{linea.descuento}} %</span>
		</div>
	</div>
</div>

<div class="importe">
	<div class="total-importe">
		{{venta.importe | fixedNumber}} €
	</div>
	<div class="controles-venta">
		<button mat-stroked-button [disabled]="venta.lineas.length===1" (click)="cancelarVenta()">Cancelar</button>
		<button class="end-btn" mat-raised-button color="primary" [disabled]="venta.lineas.length===1" (click)="terminarVenta()">Terminar</button>
	</div>
</div>

<div class="modal-bg"  [ngClass]="{'show': muestraDescuento}">
	<div class="modal-box">
		<div class="modal-header">
			Descuento
			<a href="#" (click)="cerrarDescuento($event)">
				<mat-icon>close</mat-icon>
			</a>
		</div>
		<div class="modal-body descuento-box">
			<div class="descuento-options">
				<button mat-raised-button color="primary" *ngFor="let descuento of descuentoOptions" (click)="selectDescuento(descuento)">{{descuento}} %</button>
			</div>
			<div class="descuento-otros">
				<mat-form-field>
					<input matInput type="number" min="0" max="100" step="1" placeholder="Otro" [(ngModel)]="descuentoOtro">
				</mat-form-field>
				<button mat-raised-button color="primary">Continuar</button>
			</div>
		</div>
	</div>
</div>
